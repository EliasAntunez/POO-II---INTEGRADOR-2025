<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" 
      th:replace="~{layouts/base :: layout(title=~{::title}, content=~{::content})}">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modificar Servicio</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<body>
    <th:block th:fragment="content">
            <div class="container mt-4 mb-5" style="max-width: 900px;">
                
                <div class="card shadow-sm border-0">
                    
                    <div class="card-header text-white" style="background-color: rgb(140, 55, 220);">
                        <h1 class="h4 mb-0 d-flex align-items-center">
                            <i class="bi bi-pencil-fill me-2"></i>
                            Modificar Servicio
                        </h1>
                    </div>

                    <!-- Errores globales -->
                    <div th:if="${#fields.hasErrors('global')}" class="alert alert-danger mx-3 mt-3" role="alert">
                        <ul class="mb-0">
                            <li th:each="err : ${#fields.errors('global')}" th:text="${err}"></li>
                        </ul>
                    </div>

                    <form th:action="@{/servicios/modificar}" method="post" th:object="${servicio}" id="formServicioModificar">
                        <div class="card-body p-4">
                            
                            <input type="hidden" th:field="*{id}" />

                            <h5 class="mt-4 mb-3 border-bottom pb-2">Datos del Servicio</h5>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="nombreServicio" class="form-label">Nombre del Servicio <span class="text-danger">*</span></label>
                                    <input type="text" id="nombreServicio" th:field="*{nombre}" 
                                           class="form-control" th:classappend="${#fields.hasErrors('nombre')} ? 'is-invalid'" 
                                           required maxlength="100">
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('nombre')}" th:errors="*{nombre}"></div>
                                </div>

                                <div class="col-md-6">
                                    <label for="precio" class="form-label">Precio <span class="text-danger">*</span></label>
                                    <input type="number" id="precio" th:field="*{precio}" 
                                           class="form-control" th:classappend="${#fields.hasErrors('precio')} ? 'is-invalid'" 
                                           required step="0.01" min="0.01">
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('precio')}" th:errors="*{precio}"></div>
                                </div>

                                <div class="col-12">
                                    <label for="descripcion" class="form-label">Descripción <span class="text-danger">*</span></label>
                                    <textarea id="descripcion" th:field="*{descripcion}" 
                                              class="form-control" th:classappend="${#fields.hasErrors('descripcion')} ? 'is-invalid'" 
                                              required maxlength="500" rows="3"></textarea>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('descripcion')}" th:errors="*{descripcion}"></div>
                                </div>

                                <div class="col-md-6">
                                    <label for="alicuota" class="form-label">Alícuota <span class="text-danger">*</span></label>
                                    <select id="alicuota" th:field="*{alicuota}" 
                                            class="form-select" th:classappend="${#fields.hasErrors('alicuota')} ? 'is-invalid'" 
                                            required>
                                        <option value="">-- Seleccione --</option>
                                        <option th:each="a : ${todasLasAlicuotas}" 
                                                th:value="${a}" 
                                                th:text="${a.valor + '%'}"></option>
                                    </select>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('alicuota')}" th:errors="*{alicuota}"></div>
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label d-block">Estado</label>
                                    <div class="form-check form-switch mt-2">
                                        <input class="form-check-input" type="checkbox" id="activo" th:field="*{activo}" />
                                        <label class="form-check-label" for="activo">Servicio Activo</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card-footer bg-light text-end py-3">
                            <a th:href="@{/servicios/listar}" class="btn btn-outline-secondary me-2">
                                <i class="bi bi-x-circle"></i> Cancelar
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-check-circle-fill"></i> Guardar Cambios
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </th:block>
    </body>
</html>